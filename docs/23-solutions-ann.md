# Solutions ch. 10 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##      Output
## 1  8.872277
## 2  8.178055
## 3  7.340849
## 4  7.521761
## 5  8.267819
## 6  3.285432
## 7  8.489089
## 8  8.200350
## 9  9.864419
## 10 5.169437
## 11 8.426657
## 12 7.372507
## 13 5.864573
## 14 7.433862
## 15 5.779835
## 16 9.516380
## 17 6.646284
## 18 8.196238
## 19 3.696988
## 20 8.168442
## 21 2.516092
## 22 5.859406
## 23 7.160575
## 24 7.563936
## 25 9.358802
## 26 6.464880
## 27 8.900826
## 28 7.036405
## 29 6.867256
## 30 7.682231
## 31 5.384184
## 32 6.451287
## 33 4.542279
## 34 9.418463
## 35 2.610115
## 36 7.440580
## 37 6.977172
## 38 8.883098
## 39 7.533419
## 40 9.040415
## 41 4.179137
## 42 3.245927
## 43 9.546350
## 44 5.842795
## 45 4.107612
## 46 7.283914
## 47 6.072008
## 48 9.390295
## 49 5.881607
## 50 7.264135
## 
## $covariate
##                
##  [1,] 78.717306
##  [2,] 66.880584
##  [3,] 53.888063
##  [4,] 56.576892
##  [5,] 68.356839
##  [6,] 10.794060
##  [7,] 72.064630
##  [8,] 67.245743
##  [9,] 97.306762
## [10,] 26.723075
## [11,] 71.008557
## [12,] 54.353866
## [13,] 34.393217
## [14,] 55.262298
## [15,] 33.406489
## [16,] 90.561489
## [17,] 44.173087
## [18,] 67.178322
## [19,] 13.667723
## [20,] 66.723444
## [21,]  6.330718
## [22,] 34.332642
## [23,] 51.273828
## [24,] 57.213126
## [25,] 87.587182
## [26,] 41.794676
## [27,] 79.224704
## [28,] 49.510999
## [29,] 47.159209
## [30,] 59.016667
## [31,] 28.989438
## [32,] 41.619100
## [33,] 20.632301
## [34,] 88.707443
## [35,]  6.812701
## [36,] 55.362224
## [37,] 48.680927
## [38,] 78.909437
## [39,] 56.752408
## [40,] 81.729112
## [41,] 17.465183
## [42,] 10.536044
## [43,] 91.132803
## [44,] 34.138257
## [45,] 16.872475
## [46,] 53.055402
## [47,] 36.869284
## [48,] 88.177639
## [49,] 34.593305
## [50,] 52.767664
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <bytecode: 0x555624010610>
## <environment: 0x555624012b18>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <bytecode: 0x55562400a488>
## <environment: 0x555624009998>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##        Input   Output
## 1  78.717306 8.872277
## 2  66.880584 8.178055
## 3  53.888063 7.340849
## 4  56.576892 7.521761
## 5  68.356839 8.267819
## 6  10.794060 3.285432
## 7  72.064630 8.489089
## 8  67.245743 8.200350
## 9  97.306762 9.864419
## 10 26.723075 5.169437
## 11 71.008557 8.426657
## 12 54.353866 7.372507
## 13 34.393217 5.864573
## 14 55.262298 7.433862
## 15 33.406489 5.779835
## 16 90.561489 9.516380
## 17 44.173087 6.646284
## 18 67.178322 8.196238
## 19 13.667723 3.696988
## 20 66.723444 8.168442
## 21  6.330718 2.516092
## 22 34.332642 5.859406
## 23 51.273828 7.160575
## 24 57.213126 7.563936
## 25 87.587182 9.358802
## 26 41.794676 6.464880
## 27 79.224704 8.900826
## 28 49.510999 7.036405
## 29 47.159209 6.867256
## 30 59.016667 7.682231
## 31 28.989438 5.384184
## 32 41.619100 6.451287
## 33 20.632301 4.542279
## 34 88.707443 9.418463
## 35  6.812701 2.610115
## 36 55.362224 7.440580
## 37 48.680927 6.977172
## 38 78.909437 8.883098
## 39 56.752408 7.533419
## 40 81.729112 9.040415
## 41 17.465183 4.179137
## 42 10.536044 3.245927
## 43 91.132803 9.546350
## 44 34.138257 5.842795
## 45 16.872475 4.107612
## 46 53.055402 7.283914
## 47 36.869284 6.072008
## 48 88.177639 9.390295
## 49 34.593305 5.881607
## 50 52.767664 7.264135
## 
## $exclude
## NULL
## 
## $net.result
## $net.result[[1]]
##           [,1]
##  [1,] 8.874523
##  [2,] 8.175107
##  [3,] 7.341146
##  [4,] 7.520996
##  [5,] 8.265086
##  [6,] 3.286080
##  [7,] 8.487570
##  [8,] 8.197441
##  [9,] 9.850909
## [10,] 5.168972
## [11,] 8.424700
## [12,] 7.372625
## [13,] 5.863817
## [14,] 7.433620
## [15,] 5.778787
## [16,] 9.518363
## [17,] 6.648386
## [18,] 8.193321
## [19,] 3.696276
## [20,] 8.165481
## [21,] 2.517220
## [22,] 5.858631
## [23,] 7.161787
## [24,] 7.562920
## [25,] 9.363077
## [26,] 6.466607
## [27,] 8.903370
## [28,] 7.038095
## [29,] 6.869337
## [30,] 7.680540
## [31,] 5.382896
## [32,] 6.452974
## [33,] 4.544242
## [34,] 9.422130
## [35,] 2.608622
## [36,] 7.440299
## [37,] 6.979034
## [38,] 8.885458
## [39,] 7.532584
## [40,] 9.044255
## [41,] 4.178896
## [42,] 3.246455
## [43,] 9.547624
## [44,] 5.841959
## [45,] 4.106895
## [46,] 7.284523
## [47,] 6.072142
## [48,] 9.394285
## [49,] 5.880917
## [50,] 7.264848
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##             [,1]        [,2]        [,3]        [,4]       [,5]        [,6]
## [1,] -0.57730734 -0.58515025 -0.58170087 -3.56827631 0.79696255 -0.83518616
## [2,] -0.07609005  0.05577656 -0.04148739  0.04169634 0.04034446 -0.04146541
##            [,7]      [,8]        [,9]       [,10]
## [1,] -1.2330634 -5.817847 -3.34502799  0.96105635
## [2,]  0.2919803  0.345790  0.07687179 -0.03355087
## 
## $weights[[1]][[2]]
##              [,1]
##  [1,]  1.31156906
##  [2,] -0.66571065
##  [3,]  2.94171018
##  [4,] -0.85638976
##  [5,]  3.91338637
##  [6,]  1.95532410
##  [7,] -3.01779034
##  [8,]  1.11887416
##  [9,]  0.09048138
## [10,]  0.24895315
## [11,] -1.82892649
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
##  [1,] -0.0008149194
##  [2,] -0.0010438616
##  [3,] -0.0014549438
##  [4,] -0.0013472892
##  [5,] -0.0010104543
##  [6,] -0.0203052782
##  [7,] -0.0009338327
##  [8,] -0.0010354227
##  [9,] -0.0005399908
## [10,] -0.0044650765
## [11,] -0.0009547161
## [12,] -0.0014351971
## [13,] -0.0030006377
## [14,] -0.0013980460
## [15,] -0.0031422172
## [16,] -0.0006337159
## [17,] -0.0020056170
## [18,] -0.0010369719
## [19,] -0.0134990672
## [20,] -0.0010475302
## [21,] -0.0501043034
## [22,] -0.0030090414
## [23,] -0.0015753335
## [24,] -0.0013239234
## [25,] -0.0006769519
## [26,] -0.0021942197
## [27,] -0.0008065369
## [28,] -0.0016666994
## [29,] -0.0018033915
## [30,] -0.0012616053
## [31,] -0.0039271668
## [32,] -0.0022092486
## [33,] -0.0068502492
## [34,] -0.0006605239
## [35,] -0.0447630953
## [36,] -0.0013940657
## [37,] -0.0017129008
## [38,] -0.0008117363
## [39,] -0.0013407677
## [40,] -0.0007661899
## [41,] -0.0090711918
## [42,] -0.0212017687
## [43,] -0.0006255473
## [44,] -0.0030362568
## [45,] -0.0095969309
## [46,] -0.0014914777
## [47,] -0.0026859022
## [48,] -0.0006682709
## [49,] -0.0029731361
## [50,] -0.0015044835
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##            [,1]       [,2]       [,3]       [,4]        [,5]       [,6]
## [1,]  0.2807102 -0.3885558 -0.8456951 -2.5407311  1.10082385 -0.9467057
## [2,] -0.1357695 -0.0269176 -0.2424759  0.3877415 -0.03960974 -0.1401656
##            [,7]       [,8]      [,9]       [,10]
## [1,] -0.1604834 -0.1961933 0.8141014  0.03118947
## [2,]  1.3476563  0.8930715 0.7694604 -1.00327693
## 
## $startweights[[1]][[2]]
##             [,1]
##  [1,]  0.3813115
##  [2,] -0.8689347
##  [3,]  1.6239480
##  [4,] -0.4085091
##  [5,]  0.4532899
##  [6,]  0.9815739
##  [7,] -2.7343536
##  [8,]  0.1886109
##  [9,] -0.8614465
## [10,] -0.7657423
## [11,] -0.9914455
## 
## 
## 
## $result.matrix
##                                 [,1]
## error                   1.793514e-04
## reached.threshold       7.117008e-03
## steps                   5.790000e+03
## Intercept.to.1layhid1  -5.773073e-01
## Input.to.1layhid1      -7.609005e-02
## Intercept.to.1layhid2  -5.851502e-01
## Input.to.1layhid2       5.577656e-02
## Intercept.to.1layhid3  -5.817009e-01
## Input.to.1layhid3      -4.148739e-02
## Intercept.to.1layhid4  -3.568276e+00
## Input.to.1layhid4       4.169634e-02
## Intercept.to.1layhid5   7.969625e-01
## Input.to.1layhid5       4.034446e-02
## Intercept.to.1layhid6  -8.351862e-01
## Input.to.1layhid6      -4.146541e-02
## Intercept.to.1layhid7  -1.233063e+00
## Input.to.1layhid7       2.919803e-01
## Intercept.to.1layhid8  -5.817847e+00
## Input.to.1layhid8       3.457900e-01
## Intercept.to.1layhid9  -3.345028e+00
## Input.to.1layhid9       7.687179e-02
## Intercept.to.1layhid10  9.610563e-01
## Input.to.1layhid10     -3.355087e-02
## Intercept.to.Output     1.311569e+00
## 1layhid1.to.Output     -6.657107e-01
## 1layhid2.to.Output      2.941710e+00
## 1layhid3.to.Output     -8.563898e-01
## 1layhid4.to.Output      3.913386e+00
## 1layhid5.to.Output      1.955324e+00
## 1layhid6.to.Output     -3.017790e+00
## 1layhid7.to.Output      1.118874e+00
## 1layhid8.to.Output      9.048138e-02
## 1layhid9.to.Output      2.489531e-01
## 1layhid10.to.Output    -1.828926e+00
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##           [,1]
##  [1,] 1.477766
##  [2,] 2.058722
##  [3,] 2.998689
##  [4,] 3.998790
##  [5,] 5.000520
##  [6,] 5.999808
##  [7,] 7.001800
##  [8,] 7.997086
##  [9,] 9.003501
## [10,] 9.975133
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1          1.477766
## 2      4               2          2.058722
## 3      9               3          2.998689
## 4     16               4          3.998790
## 5     25               5          5.000520
## 6     36               6          5.999808
## 7     49               7          7.001800
## 8     64               8          7.997086
## 9     81               9          9.003501
## 10   100              10          9.975133
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

