# Solutions ch. 10 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##       Output
## 1  8.4772598
## 2  4.1369100
## 3  9.4178052
## 4  9.6765829
## 5  2.4508518
## 6  5.8252565
## 7  6.5350259
## 8  5.1704461
## 9  8.0068347
## 10 7.7732383
## 11 8.6372877
## 12 5.8903959
## 13 9.8776732
## 14 4.9778776
## 15 6.2535039
## 16 9.9688365
## 17 3.0069819
## 18 0.7990424
## 19 8.8377021
## 20 3.5934429
## 21 9.9727358
## 22 5.7665474
## 23 5.1926257
## 24 6.9468768
## 25 7.0080289
## 26 2.7219919
## 27 9.9650640
## 28 3.8457620
## 29 9.0265472
## 30 4.3474728
## 31 3.9613354
## 32 9.6680405
## 33 5.4390923
## 34 3.3335383
## 35 3.4010884
## 36 5.4857679
## 37 9.6099869
## 38 8.7758209
## 39 8.7511055
## 40 3.1015805
## 41 2.1073717
## 42 5.2847408
## 43 7.4213588
## 44 7.8302534
## 45 8.5953768
## 46 8.8680308
## 47 2.3996511
## 48 5.7012742
## 49 8.9338442
## 50 6.3984774
## 
## $covariate
##                 
##  [1,] 71.8639337
##  [2,] 17.1140245
##  [3,] 88.6950541
##  [4,] 93.6362562
##  [5,]  6.0066746
##  [6,] 33.9336132
##  [7,] 42.7065640
##  [8,] 26.7335129
##  [9,] 64.1094012
## [10,] 60.4232334
## [11,] 74.6027390
## [12,] 34.6967637
## [13,] 97.5684270
## [14,] 24.7792656
## [15,] 39.1063107
## [16,] 99.3777021
## [17,]  9.0419401
## [18,]  0.6384688
## [19,] 78.1049786
## [20,] 12.9128320
## [21,] 99.4554591
## [22,] 33.2530693
## [23,] 26.9633612
## [24,] 48.2590975
## [25,] 49.1124684
## [26,]  7.4092399
## [27,] 99.3024996
## [28,] 14.7898856
## [29,] 81.4785545
## [30,] 18.9005197
## [31,] 15.6921780
## [32,] 93.4710078
## [33,] 29.5837251
## [34,] 11.1124774
## [35,] 11.5674021
## [36,] 30.0936492
## [37,] 92.3518479
## [38,] 77.0150329
## [39,] 76.5818483
## [40,]  9.6198017
## [41,]  4.4410154
## [42,] 27.9284852
## [43,] 55.0765659
## [44,] 61.3128679
## [45,] 73.8805016
## [46,] 78.6419698
## [47,]  5.7583252
## [48,] 32.5045280
## [49,] 79.8135730
## [50,] 40.9405137
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <environment: 0x7ffe52bc8cd0>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <environment: 0x7ffe52928ca8>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##         Input    Output
## 1  71.8639337 8.4772598
## 2  17.1140245 4.1369100
## 3  88.6950541 9.4178052
## 4  93.6362562 9.6765829
## 5   6.0066746 2.4508518
## 6  33.9336132 5.8252565
## 7  42.7065640 6.5350259
## 8  26.7335129 5.1704461
## 9  64.1094012 8.0068347
## 10 60.4232334 7.7732383
## 11 74.6027390 8.6372877
## 12 34.6967637 5.8903959
## 13 97.5684270 9.8776732
## 14 24.7792656 4.9778776
## 15 39.1063107 6.2535039
## 16 99.3777021 9.9688365
## 17  9.0419401 3.0069819
## 18  0.6384688 0.7990424
## 19 78.1049786 8.8377021
## 20 12.9128320 3.5934429
## 21 99.4554591 9.9727358
## 22 33.2530693 5.7665474
## 23 26.9633612 5.1926257
## 24 48.2590975 6.9468768
## 25 49.1124684 7.0080289
## 26  7.4092399 2.7219919
## 27 99.3024996 9.9650640
## 28 14.7898856 3.8457620
## 29 81.4785545 9.0265472
## 30 18.9005197 4.3474728
## 31 15.6921780 3.9613354
## 32 93.4710078 9.6680405
## 33 29.5837251 5.4390923
## 34 11.1124774 3.3335383
## 35 11.5674021 3.4010884
## 36 30.0936492 5.4857679
## 37 92.3518479 9.6099869
## 38 77.0150329 8.7758209
## 39 76.5818483 8.7511055
## 40  9.6198017 3.1015805
## 41  4.4410154 2.1073717
## 42 27.9284852 5.2847408
## 43 55.0765659 7.4213588
## 44 61.3128679 7.8302534
## 45 73.8805016 8.5953768
## 46 78.6419698 8.8680308
## 47  5.7583252 2.3996511
## 48 32.5045280 5.7012742
## 49 79.8135730 8.9338442
## 50 40.9405137 6.3984774
## 
## $exclude
## NULL
## 
## $net.result
## $net.result[[1]]
##            [,1]
##  [1,] 8.4744910
##  [2,] 4.1372336
##  [3,] 9.4232638
##  [4,] 9.6803833
##  [5,] 2.4519481
##  [6,] 5.8266406
##  [7,] 6.5382551
##  [8,] 5.1682433
##  [9,] 8.0024754
## [10,] 7.7694770
## [11,] 8.6358971
## [12,] 5.8921433
## [13,] 9.8768275
## [14,] 4.9752337
## [15,] 6.2566579
## [16,] 9.9646048
## [17,] 3.0055325
## [18,] 0.7991161
## [19,] 8.8384255
## [20,] 3.5947659
## [21,] 9.9683390
## [22,] 5.7675870
## [23,] 5.1905020
## [24,] 6.9485044
## [25,] 7.0092793
## [26,] 2.7209907
## [27,] 9.9609903
## [28,] 3.8471917
## [29,] 9.0293602
## [30,] 4.3466182
## [31,] 3.9624513
## [32,] 9.6719641
## [33,] 5.4381496
## [34,] 3.3336920
## [35,] 3.4016172
## [36,] 5.4850950
## [37,] 9.6146084
## [38,] 8.7758618
## [39,] 8.7508794
## [40,] 3.1004639
## [41,] 2.1064626
## [42,] 5.2829994
## [43,] 7.4196774
## [44,] 7.8262735
## [45,] 8.5935918
## [46,] 8.8690933
## [47,] 2.4010637
## [48,] 5.7019180
## [49,] 8.9356440
## [50,] 6.4017945
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##          [,1]        [,2]       [,3]       [,4]        [,5]        [,6]
## [1,] 22.50342 -0.51327994 -1.6524246 -0.5502409  0.15229302  0.37685607
## [2,] 22.52245  0.04726468  0.0259423  0.2197721 -0.04441152 -0.04193994
##             [,7]        [,8]        [,9]      [,10]
## [1,] -2.90096419 -0.26453016 -0.87541372 -0.5325718
## [2,]  0.03311548 -0.06019696  0.04180561  0.7461095
## 
## $weights[[1]][[2]]
##             [,1]
##  [1,]  2.0678557
##  [2,] -0.4431959
##  [3,]  0.7937761
##  [4,]  2.2687436
##  [5,]  1.3845462
##  [6,] -1.8677664
##  [7,] -0.8046895
##  [8,]  3.9747890
##  [9,] -4.0208630
## [10,]  1.0300889
## [11,]  1.2374127
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
##  [1,] -0.0009380893
##  [2,] -0.0092628136
##  [3,] -0.0006692678
##  [4,] -0.0006058619
##  [5,] -0.0568983098
##  [6,] -0.0030695855
##  [7,] -0.0021097558
##  [8,] -0.0045044326
##  [9,] -0.0011135385
## [10,] -0.0012178443
## [11,] -0.0008863380
## [12,] -0.0029606692
## [13,] -0.0005586687
## [14,] -0.0050840471
## [15,] -0.0024359276
## [16,] -0.0005378336
## [17,] -0.0276548841
## [18,]  2.6420344229
## [19,] -0.0008257368
## [20,] -0.0149573417
## [21,] -0.0005369501
## [22,] -0.0031721168
## [23,] -0.0044433017
## [24,] -0.0017309872
## [25,] -0.0016830516
## [26,] -0.0389978438
## [27,] -0.0005386890
## [28,] -0.0118478364
## [29,] -0.0007721364
## [30,] -0.0078619950
## [31,] -0.0107144236
## [32,] -0.0006079053
## [33,] -0.0038304146
## [34,] -0.0193903076
## [35,] -0.0180909511
## [36,] -0.0037266968
## [37,] -0.0006218787
## [38,] -0.0008440015
## [39,] -0.0008514033
## [40,] -0.0248631931
## [41,] -0.1045622822
## [42,] -0.0042005339
## [43,] -0.0014044201
## [44,] -0.0011911113
## [45,] -0.0008995772
## [46,] -0.0008169189
## [47,] -0.0616220518
## [48,] -0.0032912305
## [49,] -0.0007980692
## [50,] -0.0022602186
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##           [,1]      [,2]       [,3]       [,4]       [,5]       [,6]
## [1,] 0.5404658 0.5621227 -1.0131256  1.4947201 -0.7985001 -0.1537942
## [2,] 0.9594863 1.2005273 -0.1901564 -0.2870233  0.2521316 -0.6508096
##           [,7]       [,8]      [,9]      [,10]
## [1,] -1.355040 -1.1683619 0.1246008 -0.1937263
## [2,]  1.155103  0.3305996 0.7414633  1.4218633
## 
## $startweights[[1]][[2]]
##              [,1]
##  [1,]  1.23438615
##  [2,] -1.27666544
##  [3,] -0.37690684
##  [4,]  0.13462666
##  [5,]  0.33574271
##  [6,] -0.76237976
##  [7,]  0.08842614
##  [8,]  0.46219553
##  [9,] -0.84872821
## [10,] -0.53823430
## [11,]  0.02063262
## 
## 
## 
## $result.matrix
##                                 [,1]
## error                   1.451697e-04
## reached.threshold       9.086546e-03
## steps                   8.400000e+03
## Intercept.to.1layhid1   2.250342e+01
## Input.to.1layhid1       2.252245e+01
## Intercept.to.1layhid2  -5.132799e-01
## Input.to.1layhid2       4.726468e-02
## Intercept.to.1layhid3  -1.652425e+00
## Input.to.1layhid3       2.594230e-02
## Intercept.to.1layhid4  -5.502409e-01
## Input.to.1layhid4       2.197721e-01
## Intercept.to.1layhid5   1.522930e-01
## Input.to.1layhid5      -4.441152e-02
## Intercept.to.1layhid6   3.768561e-01
## Input.to.1layhid6      -4.193994e-02
## Intercept.to.1layhid7  -2.900964e+00
## Input.to.1layhid7       3.311548e-02
## Intercept.to.1layhid8  -2.645302e-01
## Input.to.1layhid8      -6.019696e-02
## Intercept.to.1layhid9  -8.754137e-01
## Input.to.1layhid9       4.180561e-02
## Intercept.to.1layhid10 -5.325718e-01
## Input.to.1layhid10      7.461095e-01
## Intercept.to.Output     2.067856e+00
## 1layhid1.to.Output     -4.431959e-01
## 1layhid2.to.Output      7.937761e-01
## 1layhid3.to.Output      2.268744e+00
## 1layhid4.to.Output      1.384546e+00
## 1layhid5.to.Output     -1.867766e+00
## 1layhid6.to.Output     -8.046895e-01
## 1layhid7.to.Output      3.974789e+00
## 1layhid8.to.Output     -4.020863e+00
## 1layhid9.to.Output      1.030089e+00
## 1layhid10.to.Output     1.237413e+00
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##            [,1]
##  [1,] 0.9524712
##  [2,] 1.9951206
##  [3,] 2.9985338
##  [4,] 4.0009692
##  [5,] 4.9973828
##  [6,] 6.0022976
##  [7,] 7.0013015
##  [8,] 7.9956463
##  [9,] 9.0025283
## [10,] 9.9944002
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1         0.9524712
## 2      4               2         1.9951206
## 3      9               3         2.9985338
## 4     16               4         4.0009692
## 5     25               5         4.9973828
## 6     36               6         6.0022976
## 7     49               7         7.0013015
## 8     64               8         7.9956463
## 9     81               9         9.0025283
## 10   100              10         9.9944002
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

