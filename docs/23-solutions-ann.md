# Solutions ch. 10 - Artificial neural networks {#solutions-ann}

Solutions to exercises of chapter \@ref(ann).

## Exercise 1


```r
library("neuralnet")
 
#To create a neural network to perform square root

#Generate 50 random numbers uniformly distributed between 0 and 100
#And store them as a dataframe
traininginput <-  as.data.frame(runif(50, min=0, max=100))
trainingoutput <- sqrt(traininginput)
 
#Column bind the data into one variable
trainingdata <- cbind(traininginput,trainingoutput)
colnames(trainingdata) <- c("Input","Output")
 
#Train the neural network
#Will have 10 hidden layers
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqrt <- neuralnet(Output~Input,trainingdata, hidden=10, threshold=0.01)
print(net.sqrt)
```

```
## $call
## neuralnet(formula = Output ~ Input, data = trainingdata, hidden = 10, 
##     threshold = 0.01)
## 
## $response
##       Output
## 1  9.5340609
## 2  5.8396888
## 3  6.9523507
## 4  5.0866477
## 5  4.6919764
## 6  9.9754331
## 7  1.3729024
## 8  6.8833931
## 9  5.2280722
## 10 6.3547088
## 11 8.0032599
## 12 9.9600790
## 13 7.4224728
## 14 3.5487232
## 15 7.5502702
## 16 4.4415838
## 17 8.4394389
## 18 3.3531717
## 19 9.4088058
## 20 7.3255746
## 21 7.2497071
## 22 9.2618109
## 23 9.0086797
## 24 9.3170365
## 25 9.8022396
## 26 4.7347086
## 27 6.5580180
## 28 9.8727293
## 29 8.1649343
## 30 6.4349071
## 31 5.8543206
## 32 9.8936051
## 33 7.8403184
## 34 9.7780486
## 35 6.6649969
## 36 7.4976857
## 37 9.7328255
## 38 9.1191764
## 39 7.5384569
## 40 4.5616408
## 41 8.3645001
## 42 5.5977195
## 43 5.6478698
## 44 7.2861556
## 45 8.8636499
## 46 9.3294635
## 47 3.9342054
## 48 8.5040004
## 49 0.7952237
## 50 1.4093643
## 
## $covariate
##                 
##  [1,] 90.8983165
##  [2,] 34.1019648
##  [3,] 48.3351802
##  [4,] 25.8739847
##  [5,] 22.0146428
##  [6,] 99.5092658
##  [7,]  1.8848611
##  [8,] 47.3811001
##  [9,] 27.3327393
## [10,] 40.3823233
## [11,] 64.0521691
## [12,] 99.2031735
## [13,] 55.0931025
## [14,] 12.5934365
## [15,] 57.0065800
## [16,] 19.7276665
## [17,] 71.2241285
## [18,] 11.2437606
## [19,] 88.5256258
## [20,] 53.6640426
## [21,] 52.5582524
## [22,] 85.7811411
## [23,] 81.1563105
## [24,] 86.8071683
## [25,] 96.0839008
## [26,] 22.4174657
## [27,] 43.0076000
## [28,] 97.4707840
## [29,] 66.6661528
## [30,] 41.4080288
## [31,] 34.2730694
## [32,] 97.8834222
## [33,] 61.4705922
## [34,] 95.6102347
## [35,] 44.4221835
## [36,] 56.2152911
## [37,] 94.7278916
## [38,] 83.1593788
## [39,] 56.8283319
## [40,] 20.8085671
## [41,] 69.9648624
## [42,] 31.3344634
## [43,] 31.8984328
## [44,] 53.0880637
## [45,] 78.5642889
## [46,] 87.0388886
## [47,] 15.4779724
## [48,] 72.3180223
## [49,]  0.6323807
## [50,]  1.9863079
## 
## $model.list
## $model.list$response
## [1] "Output"
## 
## $model.list$variables
## [1] "Input"
## 
## 
## $err.fct
## function (x, y) 
## {
##     1/2 * (y - x)^2
## }
## <environment: 0x7fdd429f3d20>
## attr(,"type")
## [1] "sse"
## 
## $act.fct
## function (x) 
## {
##     1/(1 + exp(-x))
## }
## <environment: 0x7fdd429f0f18>
## attr(,"type")
## [1] "logistic"
## 
## $linear.output
## [1] TRUE
## 
## $data
##         Input    Output
## 1  90.8983165 9.5340609
## 2  34.1019648 5.8396888
## 3  48.3351802 6.9523507
## 4  25.8739847 5.0866477
## 5  22.0146428 4.6919764
## 6  99.5092658 9.9754331
## 7   1.8848611 1.3729024
## 8  47.3811001 6.8833931
## 9  27.3327393 5.2280722
## 10 40.3823233 6.3547088
## 11 64.0521691 8.0032599
## 12 99.2031735 9.9600790
## 13 55.0931025 7.4224728
## 14 12.5934365 3.5487232
## 15 57.0065800 7.5502702
## 16 19.7276665 4.4415838
## 17 71.2241285 8.4394389
## 18 11.2437606 3.3531717
## 19 88.5256258 9.4088058
## 20 53.6640426 7.3255746
## 21 52.5582524 7.2497071
## 22 85.7811411 9.2618109
## 23 81.1563105 9.0086797
## 24 86.8071683 9.3170365
## 25 96.0839008 9.8022396
## 26 22.4174657 4.7347086
## 27 43.0076000 6.5580180
## 28 97.4707840 9.8727293
## 29 66.6661528 8.1649343
## 30 41.4080288 6.4349071
## 31 34.2730694 5.8543206
## 32 97.8834222 9.8936051
## 33 61.4705922 7.8403184
## 34 95.6102347 9.7780486
## 35 44.4221835 6.6649969
## 36 56.2152911 7.4976857
## 37 94.7278916 9.7328255
## 38 83.1593788 9.1191764
## 39 56.8283319 7.5384569
## 40 20.8085671 4.5616408
## 41 69.9648624 8.3645001
## 42 31.3344634 5.5977195
## 43 31.8984328 5.6478698
## 44 53.0880637 7.2861556
## 45 78.5642889 8.8636499
## 46 87.0388886 9.3294635
## 47 15.4779724 3.9342054
## 48 72.3180223 8.5040004
## 49  0.6323807 0.7952237
## 50  1.9863079 1.4093643
## 
## $exclude
## NULL
## 
## $net.result
## $net.result[[1]]
##            [,1]
##  [1,] 9.5414161
##  [2,] 5.8504931
##  [3,] 6.9464124
##  [4,] 5.0925064
##  [5,] 4.6866501
##  [6,] 9.9571944
##  [7,] 1.3679696
##  [8,] 6.8782614
##  [9,] 5.2367726
## [10,] 6.3580504
## [11,] 8.0001510
## [12,] 9.9431561
## [13,] 7.4141537
## [14,] 3.5506549
## [15,] 7.5423469
## [16,] 4.4290361
## [17,] 8.4442897
## [18,] 3.3713784
## [19,] 9.4194902
## [20,] 7.3172605
## [21,] 7.2415795
## [22,] 9.2746823
## [23,] 9.0218613
## [24,] 9.3292852
## [25,] 9.7969379
## [26,] 4.7307063
## [27,] 6.5577946
## [28,] 9.8626559
## [29,] 8.1645647
## [30,] 6.4368305
## [31,] 5.8649929
## [32,] 9.8819912
## [33,] 7.8349205
## [34,] 9.7742362
## [35,] 6.6629992
## [36,] 7.4895444
## [37,] 9.7316012
## [38,] 9.1326854
## [39,] 7.5304779
## [40,] 4.5523683
## [41,] 8.3678994
## [42,] 5.6096045
## [43,] 5.6597168
## [44,] 7.2779186
## [45,] 8.8755437
## [46,] 9.3415402
## [47,] 3.9186105
## [48,] 8.5100883
## [49,] 0.7971889
## [50,] 1.4092032
## 
## 
## $weights
## $weights[[1]]
## $weights[[1]][[1]]
##            [,1]        [,2]        [,3]        [,4]       [,5]       [,6]
## [1,] 0.19930475 -2.19500125 -1.86590007 -0.54712456 -1.5871765 -2.0337880
## [2,] 0.02589632  0.02898012  0.02741513  0.04382423  0.1291626  0.0282881
##            [,7]        [,8]       [,9]      [,10]
## [1,] 0.01708966  0.12212612 -0.6720379 0.87501697
## [2,] 0.02791741 -0.04927867 -0.4072311 0.04250757
## 
## $weights[[1]][[2]]
##              [,1]
##  [1,] -0.06638895
##  [2,]  0.49745970
##  [3,]  2.48276626
##  [4,]  1.99317299
##  [5,]  0.60182096
##  [6,]  1.23602156
##  [7,]  2.02628386
##  [8,]  2.27794236
##  [9,] -2.42722491
## [10,] -4.74553309
## [11,]  1.16683035
## 
## 
## 
## $generalized.weights
## $generalized.weights[[1]]
##                [,1]
##  [1,] -0.0006225524
##  [2,] -0.0029906552
##  [3,] -0.0017220146
##  [4,] -0.0048248065
##  [5,] -0.0063585388
##  [6,] -0.0005132053
##  [7,] -0.8148025471
##  [8,] -0.0017742507
##  [9,] -0.0043841021
## [10,] -0.0022688931
## [11,] -0.0011330354
## [12,] -0.0005167866
## [13,] -0.0014183653
## [14,] -0.0144470247
## [15,] -0.0013485895
## [16,] -0.0075974778
## [17,] -0.0009606727
## [18,] -0.0168966159
## [19,] -0.0006560831
## [20,] -0.0014744810
## [21,] -0.0015205398
## [22,] -0.0006969315
## [23,] -0.0007713192
## [24,] -0.0006813906
## [25,] -0.0005545197
## [26,] -0.0061688858
## [27,] -0.0020561448
## [28,] -0.0005374608
## [29,] -0.0010657777
## [30,] -0.0021810572
## [31,] -0.0029655600
## [32,] -0.0005324732
## [33,] -0.0012055390
## [34,] -0.0005604519
## [35,] -0.0019563513
## [36,] -0.0013767473
## [37,] -0.0005716492
## [38,] -0.0007381922
## [39,] -0.0013548504
## [40,] -0.0069754765
## [41,] -0.0009883343
## [42,] -0.0034553399
## [43,] -0.0033508231
## [44,] -0.0014981693
## [45,] -0.0008164429
## [46,] -0.0006779261
## [47,] -0.0108914077
## [48,] -0.0009374116
## [49,]  3.0931194454
## [50,] -0.6984658826
## 
## 
## $startweights
## $startweights[[1]]
## $startweights[[1]][[1]]
##           [,1]       [,2]       [,3]       [,4]        [,5]       [,6]
## [1,] 0.5741198 -0.6040810 -1.0901566 -0.6207338 -0.27270975 -0.8915016
## [2,] 0.6669993  0.4015395  0.4736261 -0.6662956  0.01870243  0.7730233
##            [,7]        [,8]       [,9]     [,10]
## [1,]  0.1150770 -0.01169126  0.8449783 2.0676754
## [2,] -0.2812852  0.33963734 -0.2473846 0.7071875
## 
## $startweights[[1]][[2]]
##              [,1]
##  [1,] -1.12269362
##  [2,] -0.51931226
##  [3,]  0.42793375
##  [4,]  0.26182797
##  [5,]  0.12456886
##  [6,] -0.08607944
##  [7,] -0.10953767
##  [8,]  0.94498234
##  [9,] -1.24761141
## [10,] -0.10420084
## [11,]  0.02977348
## 
## 
## 
## $result.matrix
##                                 [,1]
## error                   2.100157e-03
## reached.threshold       5.554228e-03
## steps                   2.389000e+03
## Intercept.to.1layhid1   1.993048e-01
## Input.to.1layhid1       2.589632e-02
## Intercept.to.1layhid2  -2.195001e+00
## Input.to.1layhid2       2.898012e-02
## Intercept.to.1layhid3  -1.865900e+00
## Input.to.1layhid3       2.741513e-02
## Intercept.to.1layhid4  -5.471246e-01
## Input.to.1layhid4       4.382423e-02
## Intercept.to.1layhid5  -1.587176e+00
## Input.to.1layhid5       1.291626e-01
## Intercept.to.1layhid6  -2.033788e+00
## Input.to.1layhid6       2.828810e-02
## Intercept.to.1layhid7   1.708966e-02
## Input.to.1layhid7       2.791741e-02
## Intercept.to.1layhid8   1.221261e-01
## Input.to.1layhid8      -4.927867e-02
## Intercept.to.1layhid9  -6.720379e-01
## Input.to.1layhid9      -4.072311e-01
## Intercept.to.1layhid10  8.750170e-01
## Input.to.1layhid10      4.250757e-02
## Intercept.to.Output    -6.638895e-02
## 1layhid1.to.Output      4.974597e-01
## 1layhid2.to.Output      2.482766e+00
## 1layhid3.to.Output      1.993173e+00
## 1layhid4.to.Output      6.018210e-01
## 1layhid5.to.Output      1.236022e+00
## 1layhid6.to.Output      2.026284e+00
## 1layhid7.to.Output      2.277942e+00
## 1layhid8.to.Output     -2.427225e+00
## 1layhid9.to.Output     -4.745533e+00
## 1layhid10.to.Output     1.166830e+00
## 
## attr(,"class")
## [1] "nn"
```

```r
#Plot the neural network
plot(net.sqrt)
 
#Test the neural network on some training data
testdata <- as.data.frame((1:10)^2) #Generate some squared numbers
net.results <- compute(net.sqrt, testdata) #Run them through the neural network
 
#See what properties net.sqrt has
ls(net.results)
```

```
## [1] "net.result" "neurons"
```

```r
#see the results
print(net.results$net.result)
```

```
##            [,1]
##  [1,] 0.9763998
##  [2,] 2.0845625
##  [3,] 3.0555230
##  [4,] 3.9833627
##  [5,] 5.0037321
##  [6,] 6.0090234
##  [7,] 6.9935649
##  [8,] 7.9968402
##  [9,] 9.0131297
## [10,] 9.9795845
```

```r
#Display a better version of the results
cleanoutput <- cbind(testdata,sqrt(testdata),
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
print(cleanoutput)
```

```
##    Input Expected Output Neural Net Output
## 1      1               1         0.9763998
## 2      4               2         2.0845625
## 3      9               3         3.0555230
## 4     16               4         3.9833627
## 5     25               5         5.0037321
## 6     36               6         6.0090234
## 7     49               7         6.9935649
## 8     64               8         7.9968402
## 9     81               9         9.0131297
## 10   100              10         9.9795845
```

*Acknowledgement: this example excercise was from* http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/ 

